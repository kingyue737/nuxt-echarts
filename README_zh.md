# nuxt-echarts: 在Nuxt项目中轻松集成ECharts

在Nuxt/Vue中使用ECharts需要许多额外的配置，还要注意在开启Nuxt SSR时不引入在服务端无法运行的代码。nuxt-echarts正是为了解决这些痛点而生。只需要一行命令就能完成安装，还提供了同时配置按需引入和TypeScript类型的统一设置。

[Github →](https://github.com/kingyue737/nuxt-echarts)

[文档 ->](https://echarts.nuxt.dev)

## 功能

- ⛰ **服务端渲染 (SSR):** 使用 Nuxt 服务端组件进行服务端 SVG 渲染

- ♾️ **客户端水合 (Hydration):** 按需懒加载完整的 ECharts 或轻量化的客户端运行时
- 🛠️ **可配置:** 仅导入必要的 ECharts 功能以缩小打包体积
- 🦾 **强类型支持:** 根据用户配置自动导入 ECharts 的选项类型
- 🌲 **Tree-shaking:** 只有使用到的组件才会被构建打包

## 安装

```bash
npx nuxi module add echarts
```

## 快速上手

在`nuxt.config.ts`中配置需要用到的功能（缩小打包体积，避免引入整个ECharts）：

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  modules: ['nuxt-echarts'],
  echarts: {
    charts: ['BarChart'],
    components: ['DatasetComponent', 'GridComponent', 'TooltipComponent'],
  },
})
```

然后就可以在你的项目中使用`<VChart>`组件了，如果是TypeScript项目，你还可以直接使用按照上面的配置自动生成的`ECOption`类型，为ECharts配置提供类型提示：

```vue [app/components/example.vue]
<script setup lang="ts">
const option = ref<ECOption>({
  dataset: {
    dimensions: ['Product', '2015', '2016', '2017'],
    source: [
      {
        Product: 'Matcha Latte',
        2015: 54,
        2016: 42,
        2017: 23,
      },
    ],
  },
  xAxis: { type: 'category' },
  yAxis: {},
  series: [{ type: 'bar' }],
})
</script>

<template>
  <VChart :option="option" />
</template>
```

<details>
  <summary>如何实现的</summary>
  
  nuxt-echarts 会根据你在`nuxt.config.ts`中的配置自动生成下面两个文件，自动引入到项目中:

  ```ts [app/.nuxt/echarts.mjs]
  import { use } from 'echarts/core'
  import { SVGRenderer } from 'echarts/renderers'
  import { BarChart } from 'echarts/charts'
  import {
    DatasetComponent,
    GridComponent,
    TooltipComponent,
  } from 'echarts/components'

  use([
    SVGRenderer,
    BarChart,
    DatasetComponent,
    GridComponent,
    TooltipComponent,
  ])
  ```

  ```ts [app/.nuxt/types/nuxt-echarts.d.ts]
  // Generated by nuxt-echarts

  import type { ComposeOption } from 'echarts/core'
  import type { BarSeriesOption } from 'echarts/charts'
  import type {
    DatasetComponentOption,
    GridComponentOption,
    TooltipComponentOption,
  } from 'echarts/components'

  declare global {
    export type ECOption = ComposeOption<
      | BarSeriesOption
      | DatasetComponentOption
      | GridComponentOption
      | TooltipComponentOption
    >
  }

  export {}
  ```

</details>


`<VChart>` 其实就是@Justineo大佬写的[Vue-ECharts](https://github.com/ecomfe/vue-echarts)，用法完全一样。本项目为Vue-ECharts提供了Nuxt项目的一键集成，同时还增加了ECharts 服务端渲染功能。

## 进阶功能：ECharts SSR

通常即使是开启了Nuxt的SSR，我们在使用ECharts时也仅是在客户端才渲染图表，从服务端发送过来的HTML是不含图表的。

![]()

ECharts在v5.

![]()

在文档中探索更多细节吧！
